Added indexes & removed unnecessary joins
